<div class="d-flex flex-column flex-md-row gap-4 product-info px-4">
  <%# Product Image %>
  <div class="product-image p-4 align-self-center d-flex align-items-center justify-content-center">
    <%= image_tag @product.image_url %>
  </div>
  <%# Product Name %>
  <div class="d-flex flex-column mx-2 align-items-md-start">
    <h1 class="mb-3 product-name">
      <%= @product.name%>
    </h1>
    <%# Rating %>
    <div class="star-rating">
      <%= star_rating(@product.rating_rate) %><%= @product.rating_rate %>/5
    </div>
    <%# Price %>
    <h2 class="my-2">
      <%= number_to_currency(@product.price) %>
    </h2>
    <%# Description %>
    <p class="text-secondary">
      <%= @product.description.first.capitalize %><%= @product.description.to_s[1..-1]%>
    </p>
    <%# TODO: Make size selectable if's clothing, not the backpack in men's clothing %>
    <% if ["men's clothing", "women's clothing"].include?(@product.category) && @product.name != "Fjallraven - Foldsack No. 1 Backpack, Fits 15 Laptops" %>
      <div id="size-buttons" class="size-buttons mb-3" data-controller="product">
        <p class="text-secondary mb-1">Choose size:</p>
        <button type="button" class="btn size-btn unselected" data-size="S">Small</button>
        <button type="button" class="btn size-btn unselected" data-size="M">Medium</button>
        <button type="button" class="btn size-btn unselected" data-size="L">Large</button>
        <button type="button" class="btn size-btn unselected" data-size="XL">Extra Large</button>
      </div>
    <% end %>
    <%# TODO: Make a quantity selector %>
    <%# Buttons %>
    <div class="d-flex flex-column flex-md-row gap-2 w-100 w-lg-50">
      <%# Add to cart form %>
      <% if ["men's clothing", "women's clothing"].include?(@product.category) && @product.name != "Fjallraven - Foldsack No. 1 Backpack, Fits 15 Laptops" %>
        <%= form_with url: cart_items_path, method: :post, local: true do |f| %>
          <%= f.hidden_field :product_id, value: @product.id %>
          <%= f.hidden_field :size, id: 'selected-size' %>
          <%= f.submit "Add to cart", class: "btn add-to-cart-button w-100 w-md-25" %>
        <% end %>
      <% else %>
        <%= button_to "Add to cart", cart_items_path(product_id: @product.id),
        method: :post,
        class: "btn add-to-cart-button w-100 w-md-25" %>
      <% end %>
      <%# Add to favorties button %>
      <%= button_to "Add to wishlist", favorites_path(product_id: @product.id),
      method: :post,
      class: "btn btn-primary add-to-wishlist-button w-100 w-md-25 mb-3" %>
    </div>
  </div>
</div>
<%# Break-line %>
<div class="break-line"></div>
<%# Reviews %>
<div class="px-4 reviews">
  <h5>
    <strong>All Reviews</strong>
    <span class="text-secondary review-count">(<%= @product.reviews.count %>)</span>
  </h5>
  <% if @reviews.blank? %>
    <p>No reviews yet. Be the first to review this product.</p>
  <% else %>
    <% @reviews.each do |review| %>
      <div class="review-box mt-3 mb-4 p-3">
        <strong><%= review.user&.first_name %></strong>
        <span class="text-secondary small"><%= time_ago_in_words(review.created_at) %> ago</span>
        <div class="star-rating d-flex mb-1 mt-3">
          <%= star_rating(review.rating) %>
        </div>
        <%= simple_format(h(review.comment)) %>
      </div>
    <% end %>
  <% end %>
</div>
